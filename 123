@Test
void testGetAccessToken_ApiConfigException() {
    try (MockedConstruction<OAuthRequestBuilder> mocked = 
             Mockito.mockConstruction(OAuthRequestBuilder.class,
                 (mock, context) -> {
                     // every chained call returns the same mock
                     when(mock.withClientCredentialsRequest()).thenReturn(mock);
                     when(mock.endClientCredentialsRequest()).thenReturn(mock);

                     // force exception on build
                     when(mock.build()).thenThrow(new ApiConfigException("bad"));
                 })) {

        // Run method under test
        assertThrows(ApiException.class, () -> cifApiClient.getAccessToken());
    }
}