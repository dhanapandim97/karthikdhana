@Test
void testGetAccessToken_ApiConfigException() {
    try (MockedConstruction<OAuthRequestBuilder> mocked = 
             Mockito.mockConstruction(OAuthRequestBuilder.class,
                 (mock, context) -> {
                     // mock the nested builder type
                     var nestedBuilder = Mockito.mock(OAuthRequestBuilder.OAuthClientRequestOAuthClientRequestBuilder.class);

                     // stub the chaining correctly
                     when(mock.withClientCredentialsRequest()).thenReturn(nestedBuilder);
                     when(nestedBuilder.endClientCredentialsRequest()).thenReturn(mock);

                     // final build() throws the exception
                     when(mock.build()).thenThrow(new ApiConfigException("bad"));
                 })) {

        // Run method under test
        assertThrows(ApiException.class, () -> cifApiClient.getAccessToken());
    }
}